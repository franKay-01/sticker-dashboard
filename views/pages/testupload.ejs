<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Add Stickers - G-Stickers</title>

    <% include ../partials/fav.ejs %>

    <style>
        @import url('https://fonts.googleapis.com/css?family=Montserrat');
    </style>
    <link rel="stylesheet" href="/public/assets/css/foundation.min.css">

    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700,800,900" rel="stylesheet">

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/public/assets/vendor/slick/slick.css"/>
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/public/assets/css/custom.css">
    <!--parse js-->
    <script src="https://npmcdn.com/parse/dist/parse.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <style>
        #selectedFiles img {
            max-width: 200px;
            max-height: 200px;
            float: left;
            margin-bottom:10px;
        }
    </style>
    <script>
        var selDiv = "";
        var storedFiles = [];

        $(document).ready(function() {
            $("#files").on("change", handleFileSelect);

            selDiv = $("#selectedFiles");

            $("body").on("click", ".fa-trash", removeFile);
        });

        function handleFileSelect(e) {
            var files = e.target.files;
            var filesArr = Array.prototype.slice.call(files);
            filesArr.forEach(function(f) {

                var ext = f.name.split('.').pop();
                var icon = "";
                switch (ext) {
                    case 'png':
                        icon = "fa fa-file-photo-o";
                        break;
                    case 'txt':
                        icon = "fa fa-file-text-o";
                        break;
                    default:
                        icon = "fa fa-file";


                }

                storedFiles.push(f);
                var html = "<div><i class='" + icon + "'></i><span class=name>" + f.name + "</span> <i class='fa fa-trash'></i> <br clear=\"left\"/></div>";
                selDiv.append(html);


            });

        }

        function removeFile(e) {
            var ele = $(e.target).parent().find(".name")[0]
            var file = ele.innerText;
            for(var i=0;i<storedFiles.length;i++) {
                if(storedFiles[i].name === file) {
                    storedFiles.splice(i,1);
                    break;
                }
            }
            $(this).parent().remove();
            console.log(storedFiles);
        }

    </script>
</head>
<body class="primary-background-color">

<div class="grid-container">
    <!-- Logo-->
    <div class="medium-12 large-12">
        <a href="/home">
            <img src="/public/assets/images/G_logo.png"
                 srcset="/public/assets/images/G_logo@2x.png 2x,/public/assets/images/G_logo@3x.png 3x" class="logo">
        </a>
        <a id="signoutLink" onclick="logoutUser()">LOGOUT</a>
    </div>
    <!-- End of Logo-->
    <span class="medium-12 large-12 welcome_post"><b><%= pack_name %> Sticker Pack</b></span>

    <!--Drag n Drop Form-->
    <br>
    <div class="grid-x grid-margin-x">
        <div class="medium-12 large-12 cell">
            <!-- Form to add stickers from computer-->
            <form action="/uploads" enctype="multipart/form-data" method="post">

                    Files: <input type="file" id="files" name="files" multiple><br/>

                    <div id="selectedFiles"></div>

                    <button type="button" class="clear" id="btnClearAddForm"><a href="/pack/<%= id %>"
                                                                            class="clear">Back</a></button>
                </span>
                <span>
        <button type="submit" class="upload">Upload</button>
        </span>

                <input type="hidden" name="pack_id" style="display: none" value="<%= id %>"/>
            </form>
            <!-- End of form-->
            <%- include('../partials/footer') %>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="/public/assets/js/custom.js"></script>


</html>